<?php

/**
 * Implements hook_block_info().
 */
function nefo_blocks_builder_block_info() {
  $blocks = array();

  $blocks['nefo_footer_banner'] = array(
    'info' => t('NeFo Footer Banner'),
  );

  $blocks['nefo_feature_map'] = array(
    'info' => t('Researchmap'),
    'description' => t('A block to feature the research map on the frontpage'),
  );

  return $blocks;
}

/**
* Implements hook_block_view().
*/
function nefo_blocks_builder_block_view($delta = '') {
  $block = array();

  switch ($delta) {
    case 'nefo_footer_banner':
      $block['subject'] = '';
      $block['content'] = _nefo_blocks_builder_nefo_footer_banner_content();
      break;
    case 'nefo_feature_map':
      $block['subject'] = '';
      $block['content'] = _nefo_blocks_builder_nefo_feature_map_content();
      break;
  }

  return $block;
}

function _nefo_blocks_builder_nefo_footer_banner_content() {
  $output = '<div class="nefo-footer-banner">
        <div class="nefo-footer-banner-col"><div class="nefo-footer-banner-col1"><a href="/schnittstellen/produkte">'. t('NeFo Products') .'</a></div></div>
        <div class="nefo-footer-banner-col"><div class="nefo-footer-banner-col2"><a href="/schnittstellen/produkte/workshops">'. t('Workshops') .'</a></div></div>
        <div class="nefo-footer-banner-col"><div class="nefo-footer-banner-col3"><a >'. t('Newsletter') .'</a></div></div>
        <div class="nefo-footer-banner-col"><div class="nefo-footer-banner-col4"><a href="/blogs">'. t('NeFo Blogs') .'</a></div></div>
      </div>';
  
  return $output;
}

function _nefo_blocks_builder_nefo_feature_map_content() {
  $map_url = 'forschung/forschungsakteure/forschungsatlas';
  $image = array(
    '#theme' => 'image_formatter',
    '#item' => array(
      'uri' => 'public://products/slideshow/nefo_forschungsatlas_screenshoot_16-03-2016.jpg',
      'alt' => t('example image of research map.'),
    ),
    '#path' => array(
      'path' => $map_url,
      'options' => array('html' => TRUE), // Optional.
    ),
  );

  $block = array(
    'image' => array(
      '#type' => 'container',
      '#attributes' => array('class' => array('feature-map-img')),
      'content' => $image,
    ),
    'message' => array(
      '#type' => 'container',
      '#attributes' => array('class' =>array('feature-map-text')),
      'title' => array(
        '#type' => 'markup',
        '#markup' => '<h2>' . t('Feature') . '</h2>',
      ),
      'heading' => array(
        '#type' => 'markup',
        '#markup' => '<h3>' . t('Forschungsatlas') . '</h3>',
      ),
      'description' => array(
        '#type' => 'markup',
        '#markup' => '<p>' . t('Der NeFo Atlas der Forschungsakteure enthält aktuell '.
          '1200 Einträge und 500 ForscherInnen Profile. Hier finden Sie die '.
          'passenden ExpertInnen für Ihre Fragen zur biologischen Vielfalt.') . '</p>',
      ),
      'button' => array(
        '#type' => 'container',
        '#attributes' => array('class' =>array('btn btn--blue')),
        'link#' =>array(
          '#type' => 'link',
          '#title' => t('zum Forschungsatlas'),
          '#href' => $map_url,
        ),
      ),
    ),
  );
  return $block;
}

